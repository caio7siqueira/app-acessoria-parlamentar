(()=>{var e={};e.id=693,e.ids=[693],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},7791:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>d,routeModule:()=>m,tree:()=>o});var r=a(7096),t=a(6132),i=a(7284),n=a.n(i),l=a(2564),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);a.d(s,c);let o=["",{children:["configuracoes",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,1786)),"/workspaces/app-acessoria-parlamentar/src/app/configuracoes/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,2594)),"/workspaces/app-acessoria-parlamentar/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/workspaces/app-acessoria-parlamentar/src/app/configuracoes/page.tsx"],x="/configuracoes/page",u={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/configuracoes/page",pathname:"/configuracoes",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},5239:(e,s,a)=>{Promise.resolve().then(a.bind(a,3068))},3068:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>ConfiguracoesPage});var r=a(784),t=a(9885),i=a(6658),n=a(7040),l=a(7505),c=a(5304),o=a(3560),d=a(6248),x=a(4389),u=a(8973);function ConfiguracoesPage(){let{user:e}=(0,o.a)(),{showToast:s}=(0,x.p)(),a=(0,d.Ng)(),[m,p]=(0,t.useState)(""),[h,g]=(0,t.useState)(""),[f,j]=(0,t.useState)(""),[v,b]=(0,t.useState)(""),[y,N]=(0,t.useState)(""),[_,S]=(0,t.useState)([]);(0,t.useEffect)(()=>{let s=e?.user_metadata?.nome||"";p(s),carregarUsuarios()},[e]);let carregarUsuarios=async()=>{try{let e=await fetch("/api/list-users");if(e.ok){let s=await e.json();S(s.users||[]);return}}catch(e){}try{let{data:e,error:s}=await a.auth.admin.listUsers();!s&&e&&S(e.users||[])}catch(e){console.warn("N\xe3o foi poss\xedvel listar usu\xe1rios pelo client (requer service role)"),S([])}},salvarPerfil=async()=>{let{error:e}=await a.auth.updateUser({data:{nome:m}});s(e?e.message:u.X.SUCCESS.SETTINGS_SAVED,e?"error":"success")},alterarSenha=async()=>{if(f!==v){s("As senhas n\xe3o coincidem","error");return}if(f.length<6){s("A senha deve ter pelo menos 6 caracteres","error");return}let{error:e}=await a.auth.updateUser({password:f});e?s(e.message,"error"):(s("Senha alterada com sucesso","success"),g(""),j(""),b(""))},convidarUsuario=async()=>{if(!y||!y.includes("@")){s(u.X.ERROR.INVALID_EMAIL,"error");return}try{let e=await fetch("/api/invite-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:y})}),a=await e.json();if(!e.ok){s(a.error||u.X.ERROR.GENERIC,"error");return}s(u.X.SUCCESS.USER_INVITED,"success"),N(""),carregarUsuarios()}catch(e){console.error("Erro convidar usuario:",e),s(u.X.ERROR.GENERIC,"error")}};return r.jsx(i.c,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Configura\xe7\xf5es"}),r.jsx("p",{className:"text-gray-600",children:"Prefer\xeancias da conta e do sistema"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(n.Zb,{className:"p-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Perfil"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),r.jsx(l.I,{value:m,onChange:e=>p(e.target.value)})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),r.jsx(l.I,{value:e?.email||"",disabled:!0})]}),r.jsx("div",{className:"flex gap-2 justify-end",children:r.jsx(c.z,{onClick:salvarPerfil,children:"Salvar"})})]})]}),(0,r.jsxs)(n.Zb,{className:"p-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Alterar Senha"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nova Senha"}),r.jsx(l.I,{type:"password",value:f,onChange:e=>j(e.target.value),placeholder:"M\xednimo 6 caracteres"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Senha"}),r.jsx(l.I,{type:"password",value:v,onChange:e=>b(e.target.value),placeholder:"Digite novamente"})]}),r.jsx("div",{className:"flex gap-2 justify-end",children:r.jsx(c.z,{onClick:alterarSenha,disabled:!f||!v,children:"Alterar Senha"})})]})]}),(0,r.jsxs)(n.Zb,{className:"p-6 lg:col-span-2",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Gest\xe3o de Usu\xe1rios"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(l.I,{type:"email",value:y,onChange:e=>N(e.target.value),placeholder:"email@exemplo.com",className:"flex-1"}),r.jsx(c.z,{onClick:convidarUsuario,children:"Enviar Convite"})]}),r.jsx("div",{className:"text-sm text-gray-600",children:r.jsx("p",{children:"ⓘ Um email de convite ser\xe1 enviado para o usu\xe1rio com instru\xe7\xf5es para criar a conta."})}),_.length>0&&(0,r.jsxs)("div",{className:"mt-6",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Usu\xe1rios cadastrados"}),r.jsx("div",{className:"border rounded-md divide-y",children:_.map(e=>r.jsx("div",{className:"p-3 flex items-center justify-between",children:(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium",children:e.email}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[e.email_confirmed_at?"Confirmado":"Pendente"," • Criado em ",new Date(e.created_at).toLocaleDateString("pt-BR")]})]})},e.id))})]})]})]}),(0,r.jsxs)(n.Zb,{className:"p-6 lg:col-span-2",children:[r.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Informa\xe7\xf5es do Ambiente"}),(0,r.jsxs)("ul",{className:"text-sm text-gray-700 space-y-1",children:[(0,r.jsxs)("li",{children:["Ambiente: ","production"]}),(0,r.jsxs)("li",{children:["URL do Supabase: ","configurada"]}),(0,r.jsxs)("li",{children:["Anon Key: ","configurada"]})]})]})]})]})})}},1786:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$typeof:()=>n,__esModule:()=>i,default:()=>c});var r=a(5153);let t=(0,r.createProxy)(String.raw`/workspaces/app-acessoria-parlamentar/src/app/configuracoes/page.tsx`),{__esModule:i,$$typeof:n}=t,l=t.default,c=l}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[447,887,796,511,570,839,761,215,505,973],()=>__webpack_exec__(7791));module.exports=a})();