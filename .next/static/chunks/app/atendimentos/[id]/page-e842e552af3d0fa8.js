(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[999],{8373:function(e,a,r){Promise.resolve().then(r.bind(r,6212))},6212:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return AtendimentoDetalhePage}});var t=r(7437),l=r(2265),d=r(4033),s=r(165),n=r(4874),i=r(5764),o=r(8113),c=r(3089),x=r(609),m=r(6582),u=r(2099),b=r(1484),g=r(4509),h=r(1088),k=r(9253),y=r(2898);let p=(0,y.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),N=(0,y.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function AtendimentoDetalhePage(){let e=(0,d.useParams)(),a=(0,d.useRouter)(),r=(0,s.NL)(),{showToast:y}=(0,g.p)(),v=Number(null==e?void 0:e.id),{data:j,isLoading:f,isError:E}=(0,n.a)({queryKey:["atendimento",v],queryFn:()=>u.s.buscarPorId(v),enabled:Number.isFinite(v)}),{data:w}=(0,n.a)({queryKey:["atendimento",v,"historico"],queryFn:()=>u.s.buscarHistorico(v),enabled:Number.isFinite(v)}),[C,_]=(0,l.useState)(null),[D,I]=(0,l.useState)(""),T=(null==j?void 0:j.status)==="Conclu\xeddo";(0,l.useEffect)(()=>{if(j){let{nome:e,genero:a,endereco:r,idade:t,telefone:l,solicitacao:d,prazo_data:s,prazo_urgencia:n,encaminhamento:i,secretaria:o,status:c,canal:x}=j;_({nome:e,genero:a,endereco:r,idade:t,telefone:l,solicitacao:d,prazo_data:s,prazo_urgencia:n,encaminhamento:i,secretaria:o,status:c,canal:x})}},[j]);let O=(0,i.D)({mutationFn:e=>u.s.atualizar(v,e),onSuccess:()=>{r.invalidateQueries({queryKey:["atendimento",v]}),y(h.X.SUCCESS.ATENDIMENTO_UPDATED,"success")},onError:e=>{let a=(null==e?void 0:e.message)||h.X.ERROR.ATENDIMENTO_SAVE;I(a),y(a,"error")}}),S=(0,i.D)({mutationFn:()=>u.s.excluir(v),onSuccess:()=>{y(h.X.SUCCESS.ATENDIMENTO_DELETED,"success"),a.replace("/atendimentos")},onError:e=>y((null==e?void 0:e.message)||h.X.ERROR.ATENDIMENTO_DELETE,"error")}),onSubmit=async e=>{e.preventDefault(),C&&(I(""),await O.mutateAsync(C))},handleDelete=async()=>{confirm(h.X.WARNING.CONFIRM_DELETE_ATENDIMENTO)&&("undefined"!=typeof navigator&&navigator.vibrate&&navigator.vibrate(10),await S.mutateAsync())};return Number.isFinite(v)?(0,t.jsx)(o.c,{children:(0,t.jsxs)("div",{className:"space-y-6 pb-safe",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:["Atendimento #",v]}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Visualize e edite os detalhes do atendimento"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)(k.E.div,{whileTap:{scale:.95},transition:{duration:.2},children:(0,t.jsxs)(c.z,{variant:"outline",onClick:()=>{"undefined"!=typeof navigator&&navigator.vibrate&&navigator.vibrate(10),a.back()},className:"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-neutral-700 dark:text-gray-200 dark:hover:bg-neutral-600 active:scale-95 transition-all duration-200 ease-in-out rounded-xl px-4 py-2 text-sm font-medium flex items-center gap-2 min-h-[44px]","aria-label":"Voltar para lista de atendimentos",children:[(0,t.jsx)(p,{className:"w-4 h-4"}),"Voltar"]})}),(0,t.jsx)(k.E.div,{whileTap:{scale:.95},transition:{duration:.2},children:(0,t.jsxs)(c.z,{variant:"outline",onClick:handleDelete,className:"bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-400 dark:hover:bg-red-900/50 active:scale-95 transition-all duration-200 ease-in-out rounded-xl px-4 py-2 text-sm font-medium flex items-center gap-2 min-h-[44px]","aria-label":"Excluir atendimento",children:[(0,t.jsx)(N,{className:"w-4 h-4"}),"Excluir"]})})]})]}),f||!C?(0,t.jsxs)("div",{className:"bg-white dark:bg-neutral-800 shadow rounded-lg p-6 text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-500 dark:text-gray-400",children:h.X.INFO.LOADING})]}):E?(0,t.jsx)(x.Zb,{className:"p-6",children:h.X.ERROR.ATENDIMENTO_LOAD}):(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(x.Zb,{className:"p-6 lg:col-span-2 dark:bg-neutral-800 dark:border-neutral-700",children:[T&&(0,t.jsxs)("div",{className:"mb-4 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 text-blue-700 dark:text-blue-300 px-4 py-2 rounded",children:["ⓘ ",h.X.WARNING.ATENDIMENTO_CONCLUIDO]}),D&&(0,t.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 text-red-600 dark:text-red-400 px-4 py-2 rounded",children:D}),(0,t.jsxs)("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",onSubmit:onSubmit,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome"}),(0,t.jsx)(m.I,{value:C.nome,onChange:e=>_({...C,nome:e.target.value}),required:!0,disabled:T,className:"dark:bg-neutral-700 dark:border-neutral-600 dark:text-gray-100"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"G\xeanero"}),(0,t.jsxs)("select",{className:"block w-full pl-3 pr-10 py-2 text-sm border border-gray-300 dark:border-neutral-600 rounded-md bg-white dark:bg-neutral-700 dark:text-gray-100",value:C.genero,onChange:e=>_({...C,genero:e.target.value}),disabled:T,children:[(0,t.jsx)("option",{children:"Masculino"}),(0,t.jsx)("option",{children:"Feminino"}),(0,t.jsx)("option",{children:"N\xe3o informado"})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Endere\xe7o"}),(0,t.jsx)(m.I,{value:C.endereco,onChange:e=>_({...C,endereco:e.target.value}),disabled:T,className:"dark:bg-neutral-700 dark:border-neutral-600 dark:text-gray-100"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Idade"}),(0,t.jsx)(m.I,{type:"number",value:C.idade||"",onChange:e=>_({...C,idade:Number(e.target.value)}),disabled:T,className:"dark:bg-neutral-700 dark:border-neutral-600 dark:text-gray-100"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Telefone"}),(0,t.jsx)(m.I,{value:C.telefone||"",onChange:e=>_({...C,telefone:e.target.value}),disabled:T,className:"dark:bg-neutral-700 dark:border-neutral-600 dark:text-gray-100"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Solicita\xe7\xe3o"}),(0,t.jsx)("textarea",{className:"block w-full border border-gray-300 dark:border-neutral-600 rounded-md p-2 text-sm dark:bg-neutral-700 dark:text-gray-100",rows:3,value:C.solicitacao,onChange:e=>_({...C,solicitacao:e.target.value}),disabled:T})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Prazo (data)"}),(0,t.jsx)(m.I,{type:"date",value:C.prazo_data||"",onChange:e=>_({...C,prazo_data:e.target.value}),disabled:T,className:"dark:bg-neutral-700 dark:border-neutral-600 dark:text-gray-100"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Urg\xeancia"}),(0,t.jsx)("select",{className:"block w-full pl-3 pr-10 py-2 text-sm border border-gray-300 dark:border-neutral-600 rounded-md bg-white dark:bg-neutral-700 dark:text-gray-100",value:C.prazo_urgencia,onChange:e=>_({...C,prazo_urgencia:e.target.value}),disabled:T,children:b.Qr.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Encaminhamento"}),(0,t.jsx)("select",{className:"block w-full pl-3 pr-10 py-2 text-sm border border-gray-300 dark:border-neutral-600 rounded-md bg-white dark:bg-neutral-700 dark:text-gray-100",value:C.encaminhamento,onChange:e=>_({...C,encaminhamento:e.target.value}),disabled:T,children:b.Sv.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Secretaria"}),(0,t.jsxs)("select",{className:"block w-full pl-3 pr-10 py-2 text-sm border border-gray-300 dark:border-neutral-600 rounded-md bg-white dark:bg-neutral-700 dark:text-gray-100",value:C.secretaria||"",onChange:e=>_({...C,secretaria:e.target.value}),disabled:T,children:[(0,t.jsx)("option",{value:"",children:"N\xe3o se aplica"}),b.At.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),(0,t.jsx)("select",{className:"block w-full pl-3 pr-10 py-2 text-sm border border-gray-300 dark:border-neutral-600 rounded-md bg-white dark:bg-neutral-700 dark:text-gray-100",value:C.status,onChange:e=>_({...C,status:e.target.value}),children:b.CX.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Canal"}),(0,t.jsx)("select",{className:"block w-full pl-3 pr-10 py-2 text-sm border border-gray-300 dark:border-neutral-600 rounded-md bg-white dark:bg-neutral-700 dark:text-gray-100",value:C.canal,onChange:e=>_({...C,canal:e.target.value}),disabled:T,children:b.n$.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsx)("div",{className:"md:col-span-2 flex justify-end gap-2",children:(0,t.jsx)(c.z,{type:"submit",disabled:O.isLoading||T,className:"min-h-[44px]",children:O.isLoading?h.X.INFO.SAVING:"Salvar altera\xe7\xf5es"})})]})]}),(0,t.jsxs)(x.Zb,{className:"p-6 dark:bg-neutral-800 dark:border-neutral-700",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 dark:text-gray-100",children:"Hist\xf3rico"}),w&&0!==w.length?(0,t.jsx)("ul",{className:"space-y-3",children:w.map(e=>(0,t.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium",children:e.campo_alterado}),(0,t.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:new Date(e.data_hora).toLocaleString()})]}),e.valor_anterior&&e.valor_novo&&(0,t.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:[e.valor_anterior," → ",e.valor_novo]})]},e.id))}):(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:h.X.INFO.NO_HISTORY})]})]})]})}):null}}},function(e){e.O(0,[35,406,985,529,874,253,247,113,542,971,472,744],function(){return e(e.s=8373)}),_N_E=e.O()}]);