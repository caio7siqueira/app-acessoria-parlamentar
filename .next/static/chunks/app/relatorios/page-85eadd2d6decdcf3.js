(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[223],{7805:function(e,a,t){Promise.resolve().then(t.bind(t,2304))},2304:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return RelatoriosPage}});var r=t(7437),i=t(2265),n=t(4874),s=t(8113),o=t(3089),l=t(609),c=t(6582),d=t(7893),u=t(1088);let m=(0,d.eI)("https://ivoxmhxcssydnfgormwn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml2b3htaHhjc3N5ZG5mZ29ybXduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMzUwMDYsImV4cCI6MjA3NzgxMTAwNn0.NLzp7E7pyyNPTmdXn63dQExDAA88bTTsyccB_Ba_CJM");let RelatoriosService=class RelatoriosService{static async gerarRelatorio(e){try{if(!e.data_inicio||!e.data_fim)throw Error("Datas de in\xedcio e fim s\xe3o obrigat\xf3rias.");let a=e.data_inicio,t="".concat(e.data_fim," 23:59:59"),r=m.from("atendimentos").select("*").gte("data_criacao",a).lte("data_criacao",t).order("data_criacao",{ascending:!1});e.secretarias&&e.secretarias.length>0&&(r=r.in("secretaria",e.secretarias)),e.status&&e.status.length>0&&(r=r.in("status",e.status)),e.urgencia&&e.urgencia.length>0&&(r=r.in("prazo_urgencia",e.urgencia));let{data:i,error:n}=await r;if(n)throw console.error("Erro na query de relat\xf3rio:",n),Error(u.X.ERROR.RELATORIO_GENERATE);return i||[]}catch(e){throw console.error("Erro ao gerar relat\xf3rio:",e),Error(e.message||u.X.ERROR.RELATORIO_GENERATE)}}static async exportarPDF(e){return this.exportarCSV(e)}static async exportarExcel(e){return this.exportarCSV(e)}static async exportarCSV(e){let a=await this.gerarRelatorio({...e,formato:"pdf"}),t=a.map(e=>{var a,t,r;return[e.id,'"'.concat((null===(a=e.nome)||void 0===a?void 0:a.replace(/"/g,'""'))||"",'"'),e.genero,'"'.concat((null===(t=e.endereco)||void 0===t?void 0:t.replace(/"/g,'""'))||"",'"'),e.idade||"",e.telefone||"",'"'.concat((null===(r=e.solicitacao)||void 0===r?void 0:r.replace(/"/g,'""'))||"",'"'),e.prazo_data||"",e.prazo_urgencia,e.encaminhamento,e.secretaria||"",e.status,e.canal,new Date(e.data_criacao).toLocaleString("pt-BR")].join(",")}),r=["ID,Nome,G\xeanero,Endere\xe7o,Idade,Telefone,Solicita\xe7\xe3o,Prazo,Urg\xeancia,Encaminhamento,Secretaria,Status,Canal,Data Cria\xe7\xe3o",...t].join("\n"),i=new Blob(["\uFEFF"+r],{type:"text/csv;charset=utf-8;"});return i}static baixarArquivo(e,a){let t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=a,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(t)}static async obterEstatisticasRelatorio(e){try{let a=await this.gerarRelatorio({...e,formato:"pdf"});if(!a||0===a.length)return{periodo:{inicio:e.data_inicio,fim:e.data_fim},resumo:{total_atendimentos:0,atendimentos_urgentes:0,atendimentos_concluidos:0,taxa_conclusao:0},distribuicao:{por_status:[],por_urgencia:[],por_canal:[],por_secretaria:[]}};let t=a.length,r=a.reduce((e,a)=>(e[a.status]=(e[a.status]||0)+1,e),{}),i=a.reduce((e,a)=>(e[a.prazo_urgencia]=(e[a.prazo_urgencia]||0)+1,e),{}),n=a.reduce((e,a)=>(e[a.canal]=(e[a.canal]||0)+1,e),{}),s=a.reduce((e,a)=>(a.secretaria&&(e[a.secretaria]=(e[a.secretaria]||0)+1),e),{}),o=a.filter(e=>"Urgente"===e.prazo_urgencia&&"Conclu\xeddo"!==e.status).length,l=a.filter(e=>"Conclu\xeddo"===e.status).length;return{periodo:{inicio:e.data_inicio,fim:e.data_fim},resumo:{total_atendimentos:t,atendimentos_urgentes:o,atendimentos_concluidos:l,taxa_conclusao:t>0?Math.round(l/t*100):0},distribuicao:{por_status:Object.entries(r).map(e=>{let[a,r]=e;return{status:a,quantidade:r,percentual:Math.round(r/t*100)}}),por_urgencia:Object.entries(i).map(e=>{let[a,r]=e;return{urgencia:a,quantidade:r,percentual:Math.round(r/t*100)}}),por_canal:Object.entries(n).map(e=>{let[a,r]=e;return{canal:a,quantidade:r,percentual:Math.round(r/t*100)}}),por_secretaria:Object.entries(s).map(e=>{let[a,r]=e;return{secretaria:a,quantidade:r,percentual:Math.round(r/t*100)}})}}}catch(e){throw console.error("Erro ao obter estat\xedsticas:",e),Error(e.message||u.X.ERROR.RELATORIO_GENERATE)}}};var x=t(1484),p=t(4509),g=t(6307),f=t(9253),h=t(2457),b=t(2894),y=t(9676),v=t(6629),N=t(6264),E=t(3424),j=t(4966),T=t(2549),_=t(345);function FilterTags(e){let{tags:a,onRemove:t,onClearAll:i,className:n}=e;return 0===a.length?null:(0,r.jsxs)(f.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:(0,_.cn)("flex flex-wrap items-center gap-2",n),children:[(0,r.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Filtros ativos:"}),(0,r.jsx)(g.M,{mode:"popLayout",children:a.map(e=>(0,r.jsxs)(f.E.span,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.15},className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800 dark:bg-primary-900/30 dark:text-primary-300 border border-primary-200 dark:border-primary-800",children:[e.category&&(0,r.jsxs)("span",{className:"text-primary-600 dark:text-primary-400 font-semibold",children:[e.category,":"]}),(0,r.jsx)("span",{className:"truncate max-w-[150px]",children:e.label}),(0,r.jsx)("button",{onClick:()=>t(e.value),className:"hover:bg-primary-200 dark:hover:bg-primary-800 rounded-full p-0.5 transition-colors min-h-[20px] min-w-[20px] flex items-center justify-center","aria-label":"Remover filtro ".concat(e.label),children:(0,r.jsx)(T.Z,{className:"w-3 h-3"})})]},e.value))}),i&&a.length>1&&(0,r.jsxs)(f.E.button,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},onClick:i,className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-xs font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 border border-red-200 dark:border-red-800 transition-colors",children:[(0,r.jsx)(T.Z,{className:"w-3 h-3"}),"Limpar todos"]})]})}function RelatoriosPage(){let{showToast:e}=(0,p.p)(),a=new Date,t=new Date(a.getFullYear(),a.getMonth(),1).toISOString().split("T")[0],d=a.toISOString().split("T")[0],[m,T]=(0,i.useState)(t),[_,R]=(0,i.useState)(d),[k,O]=(0,j._)("relatorios_status",[]),[w,A]=(0,j._)("relatorios_urgencia",[]),[C,I]=(0,j._)("relatorios_secretarias",[]),[S,D]=(0,i.useState)(!1),{data:L,isFetching:M,refetch:G}=(0,n.a)({queryKey:["relatorios",{dataInicio:m,dataFim:_,status:k,urgencia:w,secretarias:C}],queryFn:()=>RelatoriosService.obterEstatisticasRelatorio({data_inicio:m,data_fim:_,status:k,urgencia:w,secretarias:C}),enabled:!1}),handleGerar=async()=>{var a;D(!1);let t=await G();t.error?e(u.X.ERROR.RELATORIO_GENERATE,"error"):((null===(a=t.data)||void 0===a?void 0:a.resumo.total_atendimentos)===0&&e(u.X.WARNING.NO_DATA_FILTERS,"warning"),D(!0))},V=(0,i.useMemo)(()=>{var e,a;return[{titulo:"Total de atendimentos",valor:null!==(e=null==L?void 0:L.resumo.total_atendimentos)&&void 0!==e?e:"—",icon:h.Z},{titulo:"Urgentes em aberto",valor:null!==(a=null==L?void 0:L.resumo.atendimentos_urgentes)&&void 0!==a?a:"—",icon:b.Z},{titulo:"Taxa de conclus\xe3o",valor:L?"".concat(L.resumo.taxa_conclusao,"%"):"—",icon:y.Z}]},[L]),X=(0,i.useMemo)(()=>{let e=[];return k.forEach(a=>e.push({label:a,value:"status-".concat(a),category:"Status"})),w.forEach(a=>e.push({label:a,value:"urgencia-".concat(a),category:"Urg\xeancia"})),C.forEach(a=>e.push({label:a,value:"secretaria-".concat(a),category:"Secretaria"})),e},[k,w,C]);return(0,r.jsx)(s.c,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-neutral-900 pb-10 safe-area-bottom",children:[(0,r.jsxs)("div",{className:"px-4 pt-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Relat\xf3rios"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Gere e visualize relat\xf3rios de atendimentos"})]}),(0,r.jsxs)(l.Zb,{className:"m-4 p-4 md:p-6 dark:bg-neutral-800 dark:border-neutral-700",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Data In\xedcio"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(v.Z,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),(0,r.jsx)(c.I,{type:"date",value:m,onChange:e=>T(e.target.value),className:"pl-9 dark:bg-neutral-700 dark:border-neutral-600 dark:text-gray-100"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Data Fim"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(v.Z,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),(0,r.jsx)(c.I,{type:"date",value:_,onChange:e=>R(e.target.value),className:"pl-9 dark:bg-neutral-700 dark:border-neutral-600 dark:text-gray-100"})]})]}),(0,r.jsx)("div",{className:"md:col-span-2",children:(0,r.jsx)(o.z,{onClick:handleGerar,disabled:M,"aria-label":"Gerar relat\xf3rio",className:"w-full md:w-auto mobile-button min-h-[44px]",children:M?(0,r.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,r.jsx)(N.Z,{className:"w-4 h-4 animate-spin"})," ",u.X.INFO.GENERATING_REPORT]}):"Gerar Relat\xf3rio"})})]}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),(0,r.jsx)(E.h,{items:x.CX,multiple:!0,value:k,onChange:O,placeholder:"Selecione status",ariaLabel:"Filtrar por status",showChips:!1})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Urg\xeancia"}),(0,r.jsx)(E.h,{items:x.Qr,multiple:!0,value:w,onChange:A,placeholder:"Selecione urg\xeancias",ariaLabel:"Filtrar por urg\xeancia",showChips:!1})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Secretarias"}),(0,r.jsx)(E.h,{items:x.At,multiple:!0,value:C,onChange:I,placeholder:"Selecione secretarias",ariaLabel:"Filtrar por secretarias",showChips:!1})]})]}),X.length>0&&(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-neutral-700",children:(0,r.jsx)(FilterTags,{tags:X,onRemove:e=>{e.startsWith("status-")?O(k.filter(a=>"status-".concat(a)!==e)):e.startsWith("urgencia-")?A(w.filter(a=>"urgencia-".concat(a)!==e)):e.startsWith("secretaria-")&&I(C.filter(a=>"secretaria-".concat(a)!==e))},onClearAll:()=>{O([]),A([]),I([])}})})]}),(0,r.jsx)("div",{className:"px-4",children:(0,r.jsx)(g.M,{children:S&&(0,r.jsx)(f.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.25},className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:V.map((e,a)=>{let{titulo:t,valor:i,icon:n}=e;return(0,r.jsx)(f.E.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:.05*a},children:(0,r.jsxs)(l.Zb,{className:"p-6 dark:bg-neutral-800 dark:border-neutral-700",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t}),(0,r.jsx)(n,{className:"w-5 h-5 text-gray-400"})]}),(0,r.jsx)("p",{className:"text-3xl font-bold mt-1 text-gray-900 dark:text-gray-100",children:i})]})},t)})})})}),(0,r.jsx)("div",{className:"px-4 mt-4",children:(0,r.jsx)(g.M,{children:S&&(0,r.jsxs)(f.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.25},className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,r.jsxs)(l.Zb,{className:"p-6 dark:bg-neutral-800 dark:border-neutral-700",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Por status"}),(0,r.jsx)("ul",{className:"space-y-2",children:(null==L?void 0:L.distribuicao.por_status.length)?L.distribuicao.por_status.map(e=>(0,r.jsxs)("li",{className:"flex justify-between text-sm text-gray-700 dark:text-gray-200",children:[(0,r.jsx)("span",{children:e.status}),(0,r.jsxs)("span",{children:[e.quantidade," (",e.percentual,"%)"]})]},e.status)):(0,r.jsx)("li",{className:"text-sm text-gray-500 dark:text-gray-400",children:u.X.WARNING.NO_DATA})})]}),(0,r.jsxs)(l.Zb,{className:"p-6 dark:bg-neutral-800 dark:border-neutral-700",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Por urg\xeancia"}),(0,r.jsx)("ul",{className:"space-y-2",children:(null==L?void 0:L.distribuicao.por_urgencia.length)?L.distribuicao.por_urgencia.map(e=>(0,r.jsxs)("li",{className:"flex justify-between text-sm text-gray-700 dark:text-gray-200",children:[(0,r.jsx)("span",{children:e.urgencia}),(0,r.jsxs)("span",{children:[e.quantidade," (",e.percentual,"%)"]})]},e.urgencia)):(0,r.jsx)("li",{className:"text-sm text-gray-500 dark:text-gray-400",children:u.X.WARNING.NO_DATA})})]}),(0,r.jsxs)(l.Zb,{className:"p-6 dark:bg-neutral-800 dark:border-neutral-700",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Por canal"}),(0,r.jsx)("ul",{className:"space-y-2",children:(null==L?void 0:L.distribuicao.por_canal.length)?L.distribuicao.por_canal.map(e=>(0,r.jsxs)("li",{className:"flex justify-between text-sm text-gray-700 dark:text-gray-200",children:[(0,r.jsx)("span",{children:e.canal}),(0,r.jsxs)("span",{children:[e.quantidade," (",e.percentual,"%)"]})]},e.canal)):(0,r.jsx)("li",{className:"text-sm text-gray-500 dark:text-gray-400",children:u.X.WARNING.NO_DATA})})]}),(0,r.jsxs)(l.Zb,{className:"p-6 dark:bg-neutral-800 dark:border-neutral-700",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Por secretaria"}),(0,r.jsx)("ul",{className:"space-y-2",children:(null==L?void 0:L.distribuicao.por_secretaria.length)?L.distribuicao.por_secretaria.map(e=>(0,r.jsxs)("li",{className:"flex justify-between text-sm text-gray-700 dark:text-gray-200",children:[(0,r.jsx)("span",{children:e.secretaria}),(0,r.jsxs)("span",{children:[e.quantidade," (",e.percentual,"%)"]})]},e.secretaria)):(0,r.jsx)("li",{className:"text-sm text-gray-500 dark:text-gray-400",children:u.X.WARNING.NO_DATA})})]})]})})}),(0,r.jsxs)("div",{className:"px-4 mt-4 flex flex-col sm:flex-row gap-2",children:[(0,r.jsx)(o.z,{onClick:async()=>{try{"undefined"!=typeof navigator&&navigator.vibrate&&navigator.vibrate(10);let a=await RelatoriosService.exportarCSV({data_inicio:m,data_fim:_,status:k,urgencia:w,secretarias:C});RelatoriosService.baixarArquivo(a,"relatorio_".concat(m,"_").concat(_,".csv")),e(u.X.SUCCESS.RELATORIO_EXPORTED,"success")}catch(a){e((null==a?void 0:a.message)||u.X.ERROR.RELATORIO_EXPORT,"error")}},"aria-label":"Exportar CSV",className:"mobile-button min-h-[44px]",children:"Exportar CSV"}),(0,r.jsx)(o.z,{variant:"outline",onClick:async()=>{try{"undefined"!=typeof navigator&&navigator.vibrate&&navigator.vibrate(10);let a=await RelatoriosService.exportarCSV({data_inicio:m,data_fim:_,status:k,urgencia:w,secretarias:C});RelatoriosService.baixarArquivo(a,"relatorio_".concat(m,"_").concat(_,".csv")),e(u.X.SUCCESS.RELATORIO_EXPORTED,"success")}catch(a){e((null==a?void 0:a.message)||u.X.ERROR.RELATORIO_EXPORT,"error")}},"aria-label":"Exportar Excel (CSV)",className:"mobile-button dark:border-neutral-600 dark:text-gray-200 dark:hover:bg-neutral-700 min-h-[44px]",children:"Exportar Excel (CSV)"})]})]})})}},3089:function(e,a,t){"use strict";t.d(a,{z:function(){return c}});var r=t(7437),i=t(2265),n=t(4949),s=t(6061),o=t(345);let l=(0,s.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10",mobile:"h-12 px-6 text-base"}},defaultVariants:{variant:"default",size:"default"}}),c=i.forwardRef((e,a)=>{let{className:t,variant:i,size:s,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,r.jsx)(u,{className:(0,o.cn)(l({variant:i,size:s,className:t})),ref:a,...d})});c.displayName="Button"},609:function(e,a,t){"use strict";t.d(a,{Zb:function(){return s}});var r=t(7437),i=t(2265),n=t(345);let s=i.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,r.jsx)("div",{ref:a,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...i})});s.displayName="Card";let o=i.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,r.jsx)("div",{ref:a,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...i})});o.displayName="CardHeader";let l=i.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,r.jsx)("h3",{ref:a,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...i})});l.displayName="CardTitle";let c=i.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,r.jsx)("p",{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",t),...i})});c.displayName="CardDescription";let d=i.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,r.jsx)("div",{ref:a,className:(0,n.cn)("p-6 pt-0",t),...i})});d.displayName="CardContent";let u=i.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,r.jsx)("div",{ref:a,className:(0,n.cn)("flex items-center p-6 pt-0",t),...i})});u.displayName="CardFooter"},3424:function(e,a,t){"use strict";t.d(a,{h:function(){return Combobox}});var r=t(7437),i=t(2265),n=t(345),s=t(3523),o=t(2549),l=t(1827),c=t(2442),d=t(6307),u=t(9253);function Combobox(e){let{items:a,placeholder:t="Selecionar...",searchPlaceholder:m="Buscar...",ariaLabel:x="Combobox",disabled:p,className:g,menuClassName:f,showChips:h=!0}=e,b=(0,i.useMemo)(()=>a.map(e=>"string"==typeof e?{label:e,value:e}:e),[a]),[y,v]=(0,i.useState)(!1),[N,E]=(0,i.useState)(""),[j,T]=(0,i.useState)(-1),_=(0,i.useRef)(null),R=(0,i.useRef)(null),k=(0,i.useRef)(null),O=(0,i.useId)(),w=(0,i.useMemo)(()=>{let e=N.trim().toLowerCase();return e?b.filter(a=>a.label.toLowerCase().includes(e)||a.value.toLowerCase().includes(e)):b},[b,N]),valueToLabel=e=>{var a,t;let r=b.find(a=>a.value===e);return null!==(t=null!==(a=null==r?void 0:r.label)&&void 0!==a?a:e)&&void 0!==t?t:""},isSelected=a=>e.multiple?e.value.includes(a):e.value===a,selectValue=a=>{if(e.multiple){let t=new Set(e.value);t.has(a)?t.delete(a):t.add(a),e.onChange(Array.from(t))}else e.onChange(e.value===a?void 0:a),v(!1)},removeChip=a=>{e.multiple&&e.onChange(e.value.filter(e=>e!==a))};(0,i.useEffect)(()=>{if(!y)return;let onDoc=e=>{var a,t;let r=e.target;(null===(a=_.current)||void 0===a?void 0:a.contains(r))||(null===(t=R.current)||void 0===t?void 0:t.contains(r))||v(!1)};return document.addEventListener("mousedown",onDoc),()=>document.removeEventListener("mousedown",onDoc)},[y]),(0,i.useEffect)(()=>{y&&T(w.length?0:-1)},[y,w.length]);let A="".concat(O,"-listbox"),C=j>=0?"".concat(O,"-opt-").concat(j):void 0,I=(0,i.useMemo)(()=>{if(!e.multiple)return e.value?valueToLabel(e.value):t;{let a=e.value.map(e=>valueToLabel(e)).filter(Boolean);return 0===a.length?t:a.length<=2?a.join(", "):"".concat(a.slice(0,2).join(", ")," +").concat(a.length-2)}},[e,t]),S=(0,i.useMemo)(()=>e.multiple&&h?e.value.map(e=>({value:e,label:valueToLabel(e)})):[],[e,h]),D=e.multiple?e.value.length>0:!!e.value;return(0,r.jsxs)("div",{className:(0,n.cn)("relative",g),children:[(0,r.jsxs)("button",{ref:_,type:"button",className:(0,n.cn)("w-full flex items-center justify-between gap-2 px-3 py-3 rounded-lg border bg-white text-gray-900 dark:bg-neutral-800 dark:text-gray-100 dark:border-neutral-700","min-h-[44px] text-left transition-all",p&&"opacity-50 cursor-not-allowed",y&&"ring-2 ring-primary-500 border-primary-500"),"aria-haspopup":"listbox","aria-expanded":y,"aria-controls":A,"aria-activedescendant":C,onClick:()=>!p&&v(e=>!e),onKeyDown:e=>{if(!y){("ArrowDown"===e.key||"Enter"===e.key||" "===e.key)&&(e.preventDefault(),v(!0),setTimeout(()=>{var e;return null===(e=k.current)||void 0===e?void 0:e.focus()},0));return}if("Escape"===e.key){var a;v(!1),null===(a=_.current)||void 0===a||a.focus();return}if("ArrowDown"===e.key){e.preventDefault(),T(e=>Math.min(w.length-1,e+1));return}if("ArrowUp"===e.key){e.preventDefault(),T(e=>Math.max(0,e-1));return}if("Home"===e.key){e.preventDefault(),T(0);return}if("End"===e.key){e.preventDefault(),T(w.length-1);return}if("Enter"===e.key){e.preventDefault();let a=w[j];a&&selectValue(a.value);return}},"aria-label":x,children:[(0,r.jsx)("span",{className:(0,n.cn)("truncate flex-1",!e.value&&"text-gray-500 dark:text-gray-400"),children:I}),(0,r.jsx)(s.Z,{className:(0,n.cn)("w-4 h-4 text-gray-500 dark:text-gray-400 transition-transform",y&&"rotate-180")})]}),(0,r.jsx)(d.M,{children:h&&S.length>0&&(0,r.jsx)(u.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"flex flex-wrap gap-2 mt-2",children:S.map(e=>(0,r.jsxs)(u.E.span,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium bg-primary-100 text-primary-800 dark:bg-primary-900/30 dark:text-primary-300 border border-primary-200 dark:border-primary-800",children:[(0,r.jsx)("span",{className:"truncate max-w-[120px]",children:e.label}),(0,r.jsx)("button",{onClick:a=>{a.stopPropagation(),removeChip(e.value)},className:"hover:bg-primary-200 dark:hover:bg-primary-800 rounded p-0.5 transition-colors","aria-label":"Remover ".concat(e.label),children:(0,r.jsx)(o.Z,{className:"w-3 h-3"})})]},e.value))})}),y&&(0,r.jsxs)(u.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.15},className:(0,n.cn)("absolute z-50 mt-2 w-full rounded-lg border bg-white dark:bg-neutral-800 border-gray-200 dark:border-neutral-700 shadow-lg",f),role:"presentation",children:[(0,r.jsxs)("div",{className:"p-2 border-b border-gray-200 dark:border-neutral-700",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(l.Z,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),(0,r.jsx)("input",{ref:k,value:N,onChange:e=>E(e.target.value),placeholder:m,className:"w-full pl-9 pr-3 py-2 rounded-md bg-gray-50 dark:bg-neutral-700 text-gray-900 dark:text-gray-100 placeholder:text-gray-400 border border-gray-200 dark:border-neutral-600 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),D&&(0,r.jsxs)("button",{onClick:()=>{e.multiple?e.onChange([]):e.onChange(void 0)},className:"mt-2 w-full flex items-center justify-center gap-2 px-3 py-1.5 text-xs font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors",children:[(0,r.jsx)(o.Z,{className:"w-3 h-3"}),"Limpar tudo"]})]}),(0,r.jsxs)("ul",{ref:R,id:A,role:"listbox","aria-multiselectable":e.multiple||void 0,className:"max-h-60 overflow-auto py-1",children:[0===w.length&&(0,r.jsx)("li",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"Nenhum resultado"}),w.map((e,a)=>{let t=isSelected(e.value),i=a===j;return(0,r.jsxs)("li",{id:"".concat(O,"-opt-").concat(a),role:"option","aria-selected":t,onMouseEnter:()=>T(a),onMouseDown:e=>e.preventDefault(),onClick:()=>selectValue(e.value),className:(0,n.cn)("flex items-center justify-between px-3 py-2 cursor-pointer select-none transition-colors",i?"bg-primary-50 text-primary-700 dark:bg-neutral-700 dark:text-gray-100":"text-gray-700 dark:text-gray-200",t&&"font-medium"),children:[(0,r.jsx)("span",{className:"truncate",children:e.label}),t&&(0,r.jsx)(c.Z,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"})]},e.value)})]})]})]})}},6582:function(e,a,t){"use strict";t.d(a,{I:function(){return l}});var r=t(7437),i=t(2265),n=t(6061),s=t(345);let o=(0,n.j)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{variants:{size:{default:"h-10",sm:"h-9",lg:"h-11",mobile:"h-12 text-base"}},defaultVariants:{size:"default"}}),l=i.forwardRef((e,a)=>{let{className:t,size:i,type:n,...l}=e;return(0,r.jsx)("input",{type:n,className:(0,s.cn)(o({size:i,className:t})),ref:a,...l})});l.displayName="Input"},4509:function(e,a,t){"use strict";t.d(a,{V:function(){return ToastProvider},p:function(){return useToast}});var r=t(7437),i=t(2265),n=t(2549);let s=(0,i.createContext)(void 0);function ToastProvider(e){let{children:a}=e,[t,o]=(0,i.useState)([]),l=(0,i.useCallback)(function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=Date.now().toString();o(r=>[...r,{id:t,message:e,type:a}]),setTimeout(()=>{o(e=>e.filter(e=>e.id!==t))},5e3)},[]),c=(0,i.useCallback)(e=>{o(a=>a.filter(a=>a.id!==e))},[]),getToastStyles=e=>{switch(e){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";default:return"bg-blue-50 border-blue-200 text-blue-800"}};return(0,r.jsxs)(s.Provider,{value:{showToast:l},children:[a,(0,r.jsx)("div",{className:"fixed bottom-4 right-4 z-50 space-y-2",children:t.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 rounded-lg border shadow-lg min-w-[300px] max-w-md ".concat(getToastStyles(e.type)," animate-in slide-in-from-right"),children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:e.message}),(0,r.jsx)("button",{onClick:()=>c(e.id),className:"ml-3 text-current hover:opacity-70",children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})})]},e.id))})]})}function useToast(){let e=(0,i.useContext)(s);if(!e)throw Error("useToast must be used within ToastProvider");return e}},4966:function(e,a,t){"use strict";t.d(a,{_:function(){return useLocalStorage}});var r=t(2265);function useLocalStorage(e,a){let[t,i]=(0,r.useState)(()=>{try{let t=window.localStorage.getItem(e);return t?JSON.parse(t):a}catch(e){return a}});return(0,r.useEffect)(()=>{try{window.localStorage.setItem(e,JSON.stringify(t))}catch(e){}},[e,t]),[t,i]}},345:function(e,a,t){"use strict";t.d(a,{cn:function(){return cn}});var r=t(7042),i=t(4769);function cn(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,i.m6)((0,r.W)(a))}},1484:function(e,a,t){"use strict";t.d(a,{At:function(){return r},CX:function(){return i},Qr:function(){return n},Sv:function(){return o},n$:function(){return s}});let r=["Secretaria de Sa\xfade","Secretaria de Educa\xe7\xe3o","Secretaria de Assist\xeancia Social","Secretaria de Obras","Secretaria de Meio Ambiente","Secretaria de Transporte","Secretaria de Cultura","Secretaria de Esporte"],i=["Pendente","Em Andamento","Conclu\xeddo","Cancelado"],n=["Baixa","M\xe9dia","Alta","Urgente"],s=["Presencial","Telefone","WhatsApp","E-mail","Outro"],o=["Secretaria","Informa\xe7\xe3o","Orienta\xe7\xe3o","Outro"]},1088:function(e,a,t){"use strict";t.d(a,{X:function(){return r}});let r={SUCCESS:{GENERIC:"A\xe7\xe3o conclu\xedda com sucesso!",ATENDIMENTO_CREATED:"Atendimento criado com sucesso!",ATENDIMENTO_UPDATED:"Atendimento atualizado com sucesso!",ATENDIMENTO_DELETED:"Atendimento exclu\xeddo com sucesso!",CONTATO_CREATED:"Contato criado com sucesso!",CONTATO_UPDATED:"Contato atualizado com sucesso!",CONTATO_DELETED:"Contato exclu\xeddo com sucesso!",USER_INVITED:"Convite enviado com sucesso!",RELATORIO_EXPORTED:"Relat\xf3rio exportado com sucesso!",SETTINGS_SAVED:"Configura\xe7\xf5es salvas com sucesso!"},ERROR:{GENERIC:"Ocorreu um erro. Tente novamente.",ATENDIMENTO_LOAD:"Erro ao carregar atendimento.",ATENDIMENTO_SAVE:"Erro ao salvar atendimento. Tente novamente.",ATENDIMENTO_DELETE:"Erro ao excluir atendimento.",CONTATO_LOAD:"Erro ao carregar contato.",CONTATO_SAVE:"Erro ao salvar contato. Tente novamente.",CONTATO_DELETE:"Erro ao excluir contato.",RELATORIO_GENERATE:"Erro ao gerar relat\xf3rio. Tente novamente.",RELATORIO_EXPORT:"Erro ao exportar relat\xf3rio. Tente novamente.",INVALID_CREDENTIALS:"E-mail ou senha incorretos.",USER_EXISTS:"Este e-mail j\xe1 est\xe1 cadastrado.",USER_LIMIT_REACHED:"Limite de 3 usu\xe1rios atingido para esta conta.",INVALID_EMAIL:"E-mail inv\xe1lido.",INVALID_DATA:"Dados inv\xe1lidos. Verifique os campos.",NETWORK_ERROR:"Erro de conex\xe3o. Verifique sua internet.",PERMISSION_DENIED:"Voc\xea n\xe3o tem permiss\xe3o para esta a\xe7\xe3o.",SESSION_EXPIRED:"Sua sess\xe3o expirou. Fa\xe7a login novamente."},WARNING:{UNSAVED_CHANGES:"Voc\xea tem altera\xe7\xf5es n\xe3o salvas.",CONFIRM_DELETE:"Tem certeza que deseja excluir?",CONFIRM_DELETE_ATENDIMENTO:"Tem certeza que deseja excluir este atendimento?",CONFIRM_DELETE_CONTATO:"Tem certeza que deseja excluir este contato?",NO_DATA:"Nenhum dado encontrado.",NO_DATA_FILTERS:"Nenhum dado encontrado para os filtros selecionados.",ATENDIMENTO_CONCLUIDO:"Este atendimento est\xe1 conclu\xeddo. Campos principais est\xe3o bloqueados para edi\xe7\xe3o."},INFO:{LOADING:"Carregando...",SAVING:"Salvando...",DELETING:"Excluindo...",GENERATING_REPORT:"Gerando relat\xf3rio...",EXPORTING:"Exportando...",NO_HISTORY:"Nenhum evento registrado.",NO_ATENDIMENTOS:"Nenhum atendimento encontrado.",NO_CONTATOS:"Nenhum contato encontrado."},VALIDATION:{REQUIRED_FIELD:"Este campo \xe9 obrigat\xf3rio.",INVALID_EMAIL:"E-mail inv\xe1lido.",INVALID_PHONE:"Telefone inv\xe1lido.",MIN_LENGTH:"M\xednimo de {n} caracteres.",MAX_LENGTH:"M\xe1ximo de {n} caracteres.",INVALID_DATE:"Data inv\xe1lida."}}}},function(e){e.O(0,[35,406,985,529,874,253,606,113,971,472,744],function(){return e(e.s=7805)}),_N_E=e.O()}]);